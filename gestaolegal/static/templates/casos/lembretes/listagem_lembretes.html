{% extends "base/painel_principal.html" %}
{% block titulo %} Lembretes - Caso #{{caso_id}} {{ super() }}{% endblock titulo %}
{% block conteudo %}
<div class="page-container">
  <div class="page-header">
    <div class="search-section">
      <div class="search-form">
        <div class="search-field">
          <label>Lembretes do Caso #{{ caso_id }}</label>
        </div>
      </div>
      
      <div class="total-info">
        <span>Total:</span>
        <span class="total-badge">{{ lembretes|length if lembretes else 0 }}</span>
      </div>
    </div>
    
    <div class="action-section">
      <a href="{{url_for('casos.cadastrar_lembrete', id_do_caso=caso_id)}}" class="btn btn-primary">
        Criar Lembrete
      </a>
    </div>
  </div>
    {% if lembretes %}
    <div class="row">
        {% for lembrete in lembretes %}
    
        <div class="col-12 col-lg-4">
            <div class="card  card-primary">
                <div class="card-header">
                    <h4>Lembrete #{{lembrete.num_lembrete}}</h4>
                </div>
                <div class="card-body">
                    <p class="clearfix">
                        <span class="float-left">
                        Descrição:
                        </span>
                        <div class="descricao text-muted text-right ">{{lembrete.descricao}}</div>
                    </p>
                    <p class="clearfix">
                        <span class="float-left">
                        Usuário notificado:
                        </span>
                        <span class="float-right text-muted">
                        {{lembrete.usuario.nome}}
                        </span>
                    </p>
                    <p class="clearfix">
                        <span class="float-left">
                        Data de criação:
                        </span>
                        <span class="float-right text-muted">
                        {{lembrete.data_criacao.strftime('%d/%m/%Y')}}
                        </span>
                    </p>
                    <p class="clearfix">
                        <span class="float-left">
                        Data de notificação:
                        </span>
                        <span class="float-right text-muted">
                        {{lembrete.data_lembrete.strftime('%d/%m/%Y')}}
                        </span>
                    </p>
                </div>
                <div class="card-footer text-right">
                    <a href="{{url_for('casos.editar_lembrete', id_lembrete=lembrete.id)}}"  class="btn btn-primary">Editar</a>
                    {% if current_user.urole in [UserRole.ADMINISTRADOR.value, UserRole.COLAB_EXTERNO.value, UserRole.ORIENTADOR.value, UserRole.ESTAGIARIO_DIREITO.value] %}
                    <a href="{{url_for('casos.excluir_lembrete', id_lembrete=lembrete.id)}}" class="btn ml-1 btn-flat btn-danger" 
                    onclick="return confirm('Você deseja excluir este lembrete?');">Excluir</a>
                    {% endif %}
                </div>
            </div>
        </div>
    
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
      <h4>Nenhum lembrete encontrado</h4>
      <p class="empty-message">
        Não há lembretes cadastrados para este caso no momento
      </p>
      <a href="{{url_for('casos.cadastrar_lembrete', id_do_caso=caso_id)}}" class="btn btn-primary">
        Criar primeiro lembrete
      </a>
    </div>
    {% endif %}
</div>
{% endblock conteudo %}

{% block scripts %}
<script src="{{url_for('static',filename='js/ver_mais.js')}}"></script>

<script type="text/javascript">
	document.addEventListener('DOMContentLoaded', function() {
		shortenText(".descricao", {
	        "showChars" : 30
		});
	});
</script>

{% endblock scripts %}