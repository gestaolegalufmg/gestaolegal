{% extends "base/painel_principal.html" %}

{% set eh_perfil_proprio = current_user.id == id_user %}

{%block titulo%}
<div class="row justify-content-between">
    Editar {{'meu perfil' if eh_perfil_proprio else 'Usu√°rio'}}
    {% if id_user == id_usuario_logado %}
    <form action="{{url_for('usuario.editar_senha_usuario')}}">
        <button type="submit" class="btn btn-primary btn-block">Alterar senha</button>
    </form>
    {% endif %}
</div>
{%endblock%}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/form_styles.css') }}">
{% endblock %}

{% block conteudo %}

<div class="form-container">
    <div class="form-content" style="padding-top: 0;">
        <div class="form-validation">
            <form class="form-valide" action="#" method="POST" id="form">
                <input type="hidden" id="emailAtual" name="emailAtual" value="{{entidade_usuario.email}}">
                {% include "usuarios/formularios/formulario_base_usuario.html" %}
            </form>
        </div>
    </div>
</div>
{% endblock %}


{% block scripts %}
<script src="{{url_for('static',filename='js/form_utilities.js')}}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        FormUtils.initializeForm({
            formId: 'form',
            buttonId: 'button',
            masks: [
                { selector: '#formcpf', pattern: FormUtils.MASK_PATTERNS.CPF },
                { selector: '#formcel', pattern: FormUtils.MASK_PATTERNS.CELL_PHONE },
                { selector: '#formtel', pattern: FormUtils.MASK_PATTERNS.PHONE },
                { selector: '#formcep', pattern: FormUtils.MASK_PATTERNS.CEP }
            ],
            conditionalFields: [{
                triggerId: 'bolsista',
                fieldsToToggle: ['div_tipo_bolsa', 'div_inicio_bolsa', 'div_fim_bolsa'],
                condition: (trigger) => trigger.value === 'True'
            }],
            dateRanges: [{
                startDateId: 'inicio_bolsa',
                endDateId: 'fim_bolsa'
            }],
            preventWheel: true
        });

        // Disable role field for default admin
        if (("{{id_usuario_logado}}" == "{{id_usuario_padrao}}") && ("{{id_user}}" == "{{id_usuario_padrao}}")) {
            document.getElementById('urole').disabled = true;
        }
    });
</script>
{%endblock%}